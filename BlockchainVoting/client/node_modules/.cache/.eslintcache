[{"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\index.js":"1","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\reportWebVitals.js":"2","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\App.jsx":"3","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\Home.js":"4","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\Navbar.js":"5","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\CoverPage.jsx":"6","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\Admin.js":"7","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\Vote.js":"8","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\utils\\getWeb3.js":"9","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\CoverLayout.jsx":"10","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\CandidateForm.js":"11","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\CandidateCard.js":"12","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\VotersForm.jsx":"13"},{"size":648,"mtime":1703927439161,"results":"14","hashOfConfig":"15"},{"size":377,"mtime":1703927439161,"results":"16","hashOfConfig":"15"},{"size":791,"mtime":1703927439152,"results":"17","hashOfConfig":"15"},{"size":2706,"mtime":1703927439163,"results":"18","hashOfConfig":"15"},{"size":3006,"mtime":1703927439155,"results":"19","hashOfConfig":"15"},{"size":1599,"mtime":1703927439162,"results":"20","hashOfConfig":"15"},{"size":8691,"mtime":1703929840947,"results":"21","hashOfConfig":"15"},{"size":4803,"mtime":1703927439163,"results":"22","hashOfConfig":"15"},{"size":1181,"mtime":1703927439164,"results":"23","hashOfConfig":"15"},{"size":1788,"mtime":1703927439154,"results":"24","hashOfConfig":"15"},{"size":1303,"mtime":1703927439153,"results":"25","hashOfConfig":"15"},{"size":1194,"mtime":1703927439153,"results":"26","hashOfConfig":"15"},{"size":1361,"mtime":1703928356089,"results":"27","hashOfConfig":"15"},{"filePath":"28","messages":"29","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1eg0en6",{"filePath":"30","messages":"31","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"32","messages":"33","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"34","messages":"35","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"36","messages":"37","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"38","messages":"39","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"40","messages":"41","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"42"},{"filePath":"43","messages":"44","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"45","messages":"46","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"47","messages":"48","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"49","messages":"50","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"51","messages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"53","messages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\index.js",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\reportWebVitals.js",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\App.jsx",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\Home.js",["55"],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\Navbar.js",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\CoverPage.jsx",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\Admin.js",["56","57","58"],"import { useEffect, useState, useRef } from \"react\";\r\nimport Box from \"@mui/material/Box\";\r\nimport Grid from \"@mui/material/Grid\";\r\nimport Button from \"@mui/material/Button\";\r\nimport Typography from \"@mui/material/Typography\";\r\nimport Divider from \"@mui/material/Divider\";\r\nimport Dialog from \"@mui/material/Dialog\";\r\nimport DialogActions from \"@mui/material/DialogActions\";\r\nimport DialogContent from \"@mui/material/DialogContent\";\r\nimport DialogContentText from \"@mui/material/DialogContentText\";\r\n\r\nimport Candidate from \"../components/CandidateCard\";\r\nimport CandidateForm from \"../components/CandidateForm\";\r\nimport VotersForm from \"../components/VotersForm\";\r\n\r\nexport default function Admin({ role, contract, web3, currentAccount }) {\r\n  const [electionState, setElectionState] = useState(0);\r\n  const [loading, setLoading] = useState(true);\r\n  const [candidates, setCandidates] = useState([]);\r\n  const [hightVote, setHightVote] = useState({});\r\n  const [lengthVote, setLengthVote] = useState(0);\r\n  const [open, setOpen] = useState(false);\r\n  const voterCount = useRef(0);// State để lưu trữ số lượng người được thêm vào\r\n\r\n  const incrementVoterCount = () => {\r\n    voterCount.current += 1; // Tăng biến đếm khi có địa chỉ được thêm vào\r\n  };\r\n\r\n  const getCandidates = async () => {\r\n    if (contract) {\r\n      console.log(contract);\r\n      const count = await contract.methods.candidatesCount().call();\r\n      const temp = [];\r\n      for (let i = 0; i < count; i++) {\r\n        const candidate = await contract.methods.getCandidateDetails(i).call();\r\n        temp.push({ name: candidate[0], votes: candidate[1] });\r\n      }\r\n      let itemHight = null;\r\n      let tmplengthVote = lengthVote;\r\n      for (let i = 0; i < temp.length; i++) {\r\n        if(parseInt(temp[i].votes) > tmplengthVote){\r\n          itemHight = temp[i];\r\n          tmplengthVote = temp[i].votes;\r\n        }\r\n      }\r\n      console.log(lengthVote);\r\n      setLengthVote(tmplengthVote);\r\n      setHightVote(itemHight);\r\n      setCandidates(temp);\r\n      setLoading(false);\r\n      console.log(temp);\r\n    }\r\n  };\r\n\r\n  const getElectionState = async () => {\r\n    if (contract) {\r\n      const state = await contract.methods.electionState().call();\r\n      setElectionState(parseInt(state));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if(hightVote){\r\n      if((parseInt(hightVote.votes) * 100 / parseInt(voterCount.current)) > 51){\r\n        handleAgree();\r\n      }\r\n    }\r\n    console.log(voterCount.current);\r\n  }, [parseInt(voterCount.current)])\r\n\r\n  useEffect(() => {\r\n    getElectionState();\r\n    getCandidates();\r\n  }, [contract]);\r\n\r\n  const handleEnd = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const handleAgree = async () => {\r\n    if (electionState === 0) {\r\n      try {\r\n        if (contract) {\r\n          await contract.methods.startElection().send({ from: currentAccount });\r\n          getElectionState();\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error:\", error);\r\n      }\r\n    } else if (electionState === 1) {\r\n      try {\r\n        if (contract) {\r\n          await contract.methods.endElection().send({ from: currentAccount });\r\n          getElectionState();\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error:\", error);\r\n      }\r\n    }\r\n\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <Box>\r\n      {loading ? (\r\n        <Box\r\n          sx={{\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            height: \"80vh\",\r\n          }}\r\n        >\r\n          Loading...\r\n        </Box>\r\n      ) : (\r\n        <Box>\r\n          <Grid container sx={{ mt: 0 }} spacing={4}>\r\n            <Grid item xs={12}>\r\n              <Typography align=\"center\" variant=\"h6\" color=\"textSecondary\">\r\n                ELECTION STATUS :{\" \"}\r\n                {electionState === 0 && \"Election has not started.\"}\r\n                {electionState === 1 && \"Election is in progress.\"}\r\n                {electionState === 2 && \"Election has ended.\"}\r\n              </Typography>\r\n              <Divider />\r\n            </Grid>\r\n            {electionState !== 2 && (\r\n              <Grid item xs={12} sx={{ display: \"flex\" }}>\r\n                <Button\r\n                  variant=\"contained\"\r\n                  sx={{ width: \"40%\", margin: \"auto\" }}\r\n                  onClick={handleEnd}\r\n                >\r\n                  {electionState === 0 && \"Start Election\"}\r\n                  {electionState === 1 && \"End Election\"}\r\n                </Button>\r\n              </Grid>\r\n            )}\r\n\r\n            <Grid item xs={12}>\r\n              <Typography align=\"center\" variant=\"h6\">\r\n                {electionState === 0 && \"ADD VOTERS / CANDIDATES\"}\r\n                {electionState === 1 && \"SEE LIVE RESULTS\"}\r\n                {electionState === 2 && \"FINAL ELECTION RESULT\"}\r\n              </Typography>\r\n              <Divider />\r\n            </Grid>\r\n\r\n            {electionState === 0 && (\r\n              <Grid\r\n                item\r\n                xs={12}\r\n                sx={{\r\n                  overflowY: \"hidden\",\r\n                  overflowX: \"auto\",\r\n                  display: \"flex\",\r\n                  width: \"98vw\",\r\n                  justifyContent: \"center\",\r\n                }}\r\n              >\r\n                <Box\r\n                  sx={{\r\n                    display: \"flex\",\r\n                    flexDirection: \"column\",\r\n                    width: \"100%\",\r\n                    alignItems: \"center\",\r\n                  }}\r\n                >\r\n                  <VotersForm\r\n                    contract={contract}\r\n                    web3={web3}\r\n                    currentAccount={currentAccount}\r\n                    onVoterAdded={incrementVoterCount}\r\n                  />\r\n                  <CandidateForm\r\n                    contract={contract}\r\n                    web3={web3}\r\n                    currentAccount={currentAccount}\r\n                  />\r\n                </Box>\r\n              </Grid>\r\n            )}\r\n\r\n            {electionState > 0 && (\r\n              <Grid\r\n                item\r\n                xs={12}\r\n                sx={{\r\n                  overflowY: \"hidden\",\r\n                  overflowX: \"auto\",\r\n                  display: \"flex\",\r\n                  width: \"98vw\",\r\n                  justifyContent: \"center\",\r\n                }}\r\n              >\r\n                {candidates &&\r\n                  candidates.map((candidate, index) => (\r\n                    <Box sx={{ mx: 2 }} key={index}>\r\n                      <Candidate\r\n                        id={index}\r\n                        name={candidate.name}\r\n                        voteCount={candidate.votes}\r\n                      />\r\n                    </Box>\r\n                  ))}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n          {hightVote ? (\r\n                <>\r\n                  <h2 style={{ fontSize: '23x', color: '#fff', display: 'flex' , justifyContent:'center'}}>Người có số phiếu bầu cao nhất</h2>\r\n                  <Grid\r\n                    container\r\n                    item\r\n                    xs={12}\r\n                    sx={{\r\n                      overflowY: \"hidden\",\r\n                      overflowX: \"auto\",\r\n                      justifyContent: \"center\",\r\n                    }}\r\n                  >\r\n                    <Grid item sx={{ width: \"98vw\", display: \"flex\", justifyContent: \"center\"}}>\r\n                      <Box sx={{ mx: 2 , marginTop: '50px'}}>\r\n                        <Candidate\r\n                          name={hightVote.name}\r\n                          voteCount={hightVote.votes}\r\n                        />\r\n                      </Box>\r\n                    </Grid>\r\n                  </Grid>\r\n                </>\r\n              ): <></>}\r\n          <Dialog\r\n            open={open}\r\n            onClose={handleClose}\r\n            aria-labelledby=\"alert-dialog-title\"\r\n            aria-describedby=\"alert-dialog-description\"\r\n          >\r\n            <DialogContent>\r\n              <DialogContentText id=\"alert-dialog-description\">\r\n                {electionState === 0 && \"Do you want to start the election?\"}\r\n                {electionState === 1 && \"Do you want to end the election?\"}\r\n              </DialogContentText>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={handleClose}>Disagree</Button>\r\n              <Button onClick={handleAgree} autoFocus>\r\n                Agree\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n        </Box>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n","C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\screens\\Vote.js",["59","60","61"],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\utils\\getWeb3.js",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\CoverLayout.jsx",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\CandidateForm.js",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\CandidateCard.js",[],"C:\\Users\\msii\\Downloads\\CoCheDongThuanWEB\\BlockchainVoting\\client\\src\\components\\VotersForm.jsx",[],{"ruleId":"62","severity":1,"message":"63","line":50,"column":6,"nodeType":"64","endLine":50,"endColumn":16,"suggestions":"65"},{"ruleId":"62","severity":1,"message":"66","line":69,"column":6,"nodeType":"64","endLine":69,"endColumn":36,"suggestions":"67"},{"ruleId":"62","severity":1,"message":"68","line":69,"column":7,"nodeType":"69","endLine":69,"endColumn":35},{"ruleId":"62","severity":1,"message":"70","line":74,"column":6,"nodeType":"64","endLine":74,"endColumn":16,"suggestions":"71"},{"ruleId":"72","severity":1,"message":"73","line":21,"column":10,"nodeType":"74","messageId":"75","endLine":21,"endColumn":14},{"ruleId":"72","severity":1,"message":"76","line":21,"column":16,"nodeType":"74","messageId":"75","endLine":21,"endColumn":23},{"ruleId":"62","severity":1,"message":"70","line":57,"column":6,"nodeType":"64","endLine":57,"endColumn":16,"suggestions":"77"},"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'getRole'. Either include it or remove the dependency array.","ArrayExpression",["78"],"React Hook useEffect has missing dependencies: 'handleAgree' and 'hightVote'. Either include them or remove the dependency array.",["79"],"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","CallExpression","React Hook useEffect has missing dependencies: 'getCandidates' and 'getElectionState'. Either include them or remove the dependency array.",["80"],"no-unused-vars","'open' is assigned a value but never used.","Identifier","unusedVar","'setOpen' is assigned a value but never used.",["81"],{"desc":"82","fix":"83"},{"desc":"84","fix":"85"},{"desc":"86","fix":"87"},{"desc":"86","fix":"88"},"Update the dependencies array to be: [contract, getRole]",{"range":"89","text":"90"},"Update the dependencies array to be: [handleAgree, hightVote]",{"range":"91","text":"92"},"Update the dependencies array to be: [contract, getCandidates, getElectionState]",{"range":"93","text":"94"},{"range":"95","text":"94"},[1471,1481],"[contract, getRole]",[2489,2519],"[handleAgree, hightVote]",[2597,2607],"[contract, getCandidates, getElectionState]",[1823,1833]]